{
    "contents" : "install.packages(\"XLConnect\")\nlibrary(\"XLConnect\")\n\n# Downloading FERC AMI Data\nif(!file.exists(\"ami.data\")) {dir.create(\"ami.data\")}\n\nfileUrl.2006 <- \"http://www.ferc.gov/industries/electric/indus-act/demand-response/2006/survey/meter-counts-by-type.xls\"\ndownload.file(fileUrl.2006, destfile=\"./ami.data/ami-data2006.xls\")\ndateDown.2006 <- date()\n\nfileUrl.2008 <- \"http://www.ferc.gov/industries/electric/indus-act/demand-response/2008/survey/ami_survey_responses.xls\"\ndownload.file(fileUrl.2008, destfile=\"./ami.data/ami-data2008.xls\")\ndateDown.2008 <- date()\n\nfileUrl.2010 <- \"http://www.ferc.gov/industries/electric/indus-act/demand-response/2010/ami-data.xlsx\"\ndownload.file(fileUrl.2010, destfile=\"./ami.data/ami-data2010.xlsx\")\ndateDown.2010 <- date()\n\nfileUrl.2012 <- \"http://www.ferc.gov/industries/electric/indus-act/demand-response/2012/ami-data.xlsx\"\ndownload.file(fileUrl.2012, destfile=\"./ami.data/ami-data2012.xlsx\")\ndateDown.2012 <- date()\n\nlist.files(\"ami.data\")\n\n#Converting and filtering Excel data by state from FERC databases\nami.data2006 <- readWorksheetFromFile(\"./ami.data/ami-data2006.xls\", sheet=3, header=TRUE)\n# Warning pertains to unused data points with NA values\nami.data2006.OR <-data.frame()\nami.data2006.OR <- ami.data2006[ami.data2006$State == \"OR\", ]\n\nami.data2008 <- readWorksheetFromFile(\"./ami.data/ami-data2008.xls\", sheet=1, header=TRUE)\nami.data2008.OR <-data.frame()\nami.data2008.OR <- ami.data2008[ami.data2008$State == \"OR\", ]\n\nami.data2010 <- readWorksheetFromFile(\"./ami.data/ami-data2010.xlsx\", sheet=2,header=TRUE)\nami.data2010.OR <-data.frame()\nami.data2010.OR <- ami.data2010[ami.data2010$State == \"OR\", ]\n\nami.data2012 <- readWorksheetFromFile(\"./ami.data/ami-data2012.xlsx\", sheet=2,header=TRUE)\nami.data2012.OR <-data.frame()\nami.data2012.OR <- ami.data2012[ami.data2012$State == \"OR\", ]\n\n\n# Unifying column names and dropping unused variables\ndrop.Monthly.2006 <- grepl(\"Monthly\", names(ami.data2006.OR))\nami.data2006.OR <- ami.data2006.OR[!drop.Monthly.2006]\nami.data2006.OR <- ami.data2006.OR[c(1,5,3,6:47)]\ncolnames(ami.data2006.OR)[1] <- \"UTILITY_ID\"\ncolnames(ami.data2006.OR)[3] <- \"Entity_Type\"\n\ndrop.Monthly.2008 <- grepl(\"Monthly\", names(ami.data2008.OR))\nami.data2008.OR <- ami.data2008.OR[!drop.Monthly.2008]\nami.data2008.OR <- ami.data2008.OR[c(1:2,48,3,8:25)]\ncolnames(ami.data2008.OR)[1] <- \"UTILITY_ID\"\ncolnames(ami.data2008.OR)[2] <- \"Name\"\ncolnames(ami.data2008.OR)[3] <- \"Entity_Type\"\n\n\n# Merging datapoints for 2006 & 2008 AMI data to match 2010 & 2012\n## ami.data2008.OR$ResTotalNumMeters <- colSums(ami.data2008.OR[,c(\"Q8.15Min.ResAMI\",\"Q8.Hourly.ResAMI\")],na.rm=TRUE)\nami.data2012.OR$TotalAMIMeters <- rowSums(ami.data2012.OR[,c(5,7,9)], na.rm=TRUE)\nami.data2012.OR$TotalMeters <- rowSums(ami.data2012.OR[,c(6,8,10)], na.rm=TRUE)\n\nami.data2010.OR$TotalAMIMeters <- rowSums(ami.data2010.OR[,c(5,7,9)], na.rm=TRUE)\nami.data2010.OR$TotalMeters <- rowSums(ami.data2010.OR[,c(6,8,10)], na.rm=TRUE)\n",
    "created" : 1425579045315.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1329270917",
    "id" : "3E6EC6D3",
    "lastKnownWriteTime" : 1427318456,
    "path" : "~/Documents/Thesis/Data/thesis data script.R",
    "project_path" : "thesis data script.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}